{
  "headers": [
    "#include \"freertos/FreeRTOS.h\"",
    "#include \"freertos/task.h\"",
    "#include \"esp_wifi.h\"",
    "#include \"esp_event.h\"",
    "#include \"nvs_flash.h\"",
    "#include \"esp_http_client.h\"",
    "#include \"protocol_examples_common.h\""
  ],
  "extraComponents":["set(EXTRA_COMPONENT_DIRS $ENV{IDF_PATH}/examples/common_components/protocol_examples_common)"],
  "tasks": ["xTaskCreate(&connect, \"connect to intranet\", 4 * 1024, NULL, 2, NULL);"],
  "globals": [],
  "function": [
    "// see https://www.learnesp32.com/13_example-connection on how to setup wireless",
    "esp_err_t clientEvent(esp_http_client_event_t *evt)",
    "{",
    "  switch (evt->event_id)",
    "  {",
    "  case HTTP_EVENT_ON_DATA:",
    "    printf(\"%.*s\\n\", evt->data_len, (char *)evt->data);",
    "    break;",
    "  default:",
    "    break;",
    "  }",
    "  return ESP_OK;",
    "}",
    "",
    "void connect(void *params)",
    "{",
    "  nvs_flash_init();",
    "  tcpip_adapter_init();",
    "  esp_event_loop_create_default();",
    "  example_connect();",
    "",
    "  esp_http_client_config_t clientConfig = {",
    "      .url = \"http://google.com\",",
    "      .event_handler = clientEvent};",
    "",
    "  esp_http_client_handle_t client = esp_http_client_init(&clientConfig);",
    "  esp_http_client_perform(client);",
    "  esp_http_client_cleanup(client);",
    "   while(true)",
    "      vTaskDelay(1000 / portTICK_PERIOD_MS);",
    "}"
  ]
}
